<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Configurazione Catamarano</title>
<script src="https://cdn.tailwindcss.com/3.4.16"></script>
<script>tailwind.config={theme:{extend:{colors:{primary:'#0a5c8f',secondary:'#f8b400'},borderRadius:{'none':'0px','sm':'4px',DEFAULT:'8px','md':'12px','lg':'16px','xl':'20px','2xl':'24px','3xl':'32px','full':'9999px','button':'8px'}}}}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Raleway:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
<script src="catamaran-config.js"></script>
<style>
:where([class^="ri-"])::before { content: "\f3c2"; }
body {
font-family: 'Raleway', sans-serif;
background-color: #f9fafb;
}
h1, h2, h3, h4, h5, h6 {
font-family: 'Playfair Display', serif;
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
-webkit-appearance: none;
margin: 0;
}
</style>
</head>
<body class="bg-gray-50">

<!-- Header -->
<header class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
<div class="flex justify-between items-center h-16">
<div class="flex items-center space-x-4">
<div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
<i class="ri-ship-line text-white"></i>
</div>
<h1 class="text-xl font-semibold text-gray-900">Admin Panel</h1>
</div>
<div class="flex items-center space-x-2">
<button id="save-button" class="bg-primary text-white px-4 py-2 rounded-lg flex items-center whitespace-nowrap">
<i class="ri-save-line mr-2"></i>
<span class="hidden md:inline">Salva Modifiche</span>
<span class="md:hidden">Salva</span>
</button>
</div>
</div>
</div>
</header>

<!-- Main Content -->
<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

<!-- Informazioni Base -->
<div class="lg:col-span-2">
<div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
<div class="px-6 py-4 border-b border-gray-200">
<h2 class="text-lg font-semibold text-gray-900">Informazioni Base</h2>
</div>
<div class="p-6 space-y-6">

<!-- Nome Catamarano -->
<div>
<label class="block text-sm font-medium text-gray-700 mb-2">Nome Catamarano</label>
<input type="text" id="admin-catamaran-name" value="Bali Catsmart - Violante" 
class="w-full px-4 py-2 border border-gray-300 rounded focus:border-primary focus:ring-1 focus:ring-primary">
</div>

<!-- Prezzo Base -->
<div>
<label class="block text-sm font-medium text-gray-700 mb-2">Prezzo Base</label>
<div class="flex items-center">
<span class="bg-gray-100 px-4 py-2 border border-r-0 border-gray-300 rounded-l text-gray-600">€</span>
<input type="number" id="admin-base-price" value="3499" 
class="w-40 px-4 py-2 border border-gray-300 rounded-r focus:border-primary focus:ring-1 focus:ring-primary">
</div>
</div>

<!-- Anno -->
<div>
<label class="block text-sm font-medium text-gray-700 mb-2">Anno</label>
<input type="number" id="admin-year" value="2025" 
class="w-full px-4 py-2 border border-gray-300 rounded focus:border-primary focus:ring-1 focus:ring-primary">
</div>

</div>
</div>
</div>

<!-- Prezzi Pacchetti -->
<div>
<div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
<div class="px-6 py-4 border-b border-gray-200">
<h2 class="text-lg font-semibold text-gray-900">Prezzi Pacchetti</h2>
</div>
<div class="p-6 space-y-6">

<!-- Charter -->
<div>
<h4 class="font-medium text-gray-900">Pacchetto Charter</h4>
<div class="flex items-center mt-1">
<span class="text-sm text-gray-600 mr-2">Prezzo:</span>
<div class="flex items-center">
<span class="bg-gray-100 px-2 py-1 border border-r-0 border-gray-300 rounded-l text-sm">€</span>
<input type="number" id="admin-charter-price" value="400" 
class="w-24 px-2 py-1 border border-gray-300 rounded-r text-sm focus:border-primary focus:ring-1 focus:ring-primary">
</div>
</div>
</div>

<!-- Carburante -->
<div>
<h4 class="font-medium text-gray-900">Carburante No Stress</h4>
<div class="flex items-center mt-1">
<span class="text-sm text-gray-600 mr-2">Prezzo:</span>
<div class="flex items-center">
<span class="bg-gray-100 px-2 py-1 border border-r-0 border-gray-300 rounded-l text-sm">€</span>
<input type="number" id="admin-fuel-price" value="350" 
class="w-24 px-2 py-1 border border-gray-300 rounded-r text-sm focus:border-primary focus:ring-1 focus:ring-primary">
</div>
</div>
</div>

<!-- Lenzuola -->
<div>
<h4 class="font-medium text-gray-900">Lenzuola e salviette</h4>
<div class="flex items-center mt-1">
<span class="text-sm text-gray-600 mr-2">Prezzo per ospite:</span>
<div class="flex items-center">
<span class="bg-gray-100 px-2 py-1 border border-r-0 border-gray-300 rounded-l text-sm">€</span>
<input type="number" id="admin-linens-price" value="20" 
class="w-24 px-2 py-1 border border-gray-300 rounded-r text-sm focus:border-primary focus:ring-1 focus:ring-primary">
</div>
</div>
</div>

<!-- Skipper -->
<div>
<h4 class="font-medium text-gray-900">Skipper Professionale</h4>
<div class="flex items-center mt-1">
<span class="text-sm text-gray-600 mr-2">Prezzo al giorno:</span>
<div class="flex items-center">
<span class="bg-gray-100 px-2 py-1 border border-r-0 border-gray-300 rounded-l text-sm">€</span>
<input type="number" id="admin-skipper-price" value="200" 
class="w-24 px-2 py-1 border border-gray-300 rounded-r text-sm focus:border-primary focus:ring-1 focus:ring-primary">
</div>
</div>
</div>

</div>
</div>
</div>

</div>

<!-- Bottom Save Button -->
<div class="mt-8 flex justify-center">
<button id="save-button-bottom" class="bg-primary text-white px-6 py-3 rounded-lg flex items-center">
<i class="ri-save-line mr-2"></i>
Salva Modifiche
</button>
</div>

</main>

<script>
// Funzioni globali per gestire la configurazione
window.saveConfiguration = function() {
    try {
        console.log('=== INIZIO SALVATAGGIO ===');
        const config = CatamaranStorage.load();
        
        // Aggiorna informazioni base
        const nameInput = document.getElementById('admin-catamaran-name');
        const priceInput = document.getElementById('admin-base-price');
        const yearInput = document.getElementById('admin-year');
        
        console.log('Campi trovati:');
        console.log('- Nome:', nameInput ? nameInput.value : 'NON TROVATO');
        console.log('- Prezzo:', priceInput ? priceInput.value : 'NON TROVATO');
        console.log('- Anno:', yearInput ? yearInput.value : 'NON TROVATO');
        
        if (nameInput && nameInput.value) {
            console.log('Aggiornando nome da:', config.basic.name, 'a:', nameInput.value);
            config.basic.name = nameInput.value;
        }
        if (priceInput && priceInput.value) {
            console.log('Aggiornando prezzo da:', config.basic.basePrice, 'a:', priceInput.value);
            config.basic.basePrice = parseInt(priceInput.value);
            config.basic.basePriceDisplay = parseInt(priceInput.value);
        }
        if (yearInput && yearInput.value) {
            console.log('Aggiornando anno da:', config.basic.year, 'a:', yearInput.value);
            config.basic.year = parseInt(yearInput.value);
        }
        
        // Aggiorna prezzi pacchetti
        const charterPriceInput = document.getElementById('admin-charter-price');
        const fuelPriceInput = document.getElementById('admin-fuel-price');
        const linensPriceInput = document.getElementById('admin-linens-price');
        const skipperPriceInput = document.getElementById('admin-skipper-price');
        
        if (charterPriceInput && charterPriceInput.value) {
            config.mandatoryPackages.charter.price = parseInt(charterPriceInput.value);
            console.log('Charter aggiornato:', charterPriceInput.value);
        }
        if (fuelPriceInput && fuelPriceInput.value) {
            config.mandatoryPackages.fuel.price = parseInt(fuelPriceInput.value);
            console.log('Fuel aggiornato:', fuelPriceInput.value);
        }
        if (linensPriceInput && linensPriceInput.value) {
            config.mandatoryPackages.linens.pricePerGuest = parseInt(linensPriceInput.value);
            console.log('Lenzuola aggiornate:', linensPriceInput.value);
        }
        if (skipperPriceInput && skipperPriceInput.value) {
            config.additionalServices.skipper.price = parseInt(skipperPriceInput.value);
            console.log('Skipper aggiornato:', skipperPriceInput.value);
        }
        
        // Salva la configurazione
        const saved = CatamaranStorage.save(config);
        
        if (saved) {
            console.log('✓ Configurazione salvata con successo!');
            showNotification('✓ Configurazione salvata con successo!', 'success');
        } else {
            console.log('✗ Errore nel salvataggio');
            showNotification('✗ Errore nel salvataggio della configurazione', 'error');
        }
        
    } catch (error) {
        console.error('Errore saveConfiguration:', error);
        showNotification('✗ Errore: ' + error.message, 'error');
    }
};

window.loadConfiguration = function() {
    try {
        const config = CatamaranStorage.load();
        
        // Carica informazioni base
        const nameInput = document.getElementById('admin-catamaran-name');
        const priceInput = document.getElementById('admin-base-price');
        const yearInput = document.getElementById('admin-year');
        
        if (nameInput) nameInput.value = config.basic.name;
        if (priceInput) priceInput.value = config.basic.basePrice;
        if (yearInput) yearInput.value = config.basic.year;
        
        // Carica prezzi pacchetti
        const charterPriceInput = document.getElementById('admin-charter-price');
        const fuelPriceInput = document.getElementById('admin-fuel-price');
        const linensPriceInput = document.getElementById('admin-linens-price');
        const skipperPriceInput = document.getElementById('admin-skipper-price');
        
        if (charterPriceInput) charterPriceInput.value = config.mandatoryPackages.charter.price;
        if (fuelPriceInput) fuelPriceInput.value = config.mandatoryPackages.fuel.price;
        if (linensPriceInput) linensPriceInput.value = config.mandatoryPackages.linens.pricePerGuest;
        if (skipperPriceInput) skipperPriceInput.value = config.additionalServices.skipper.price;
        
        console.log('✓ Configurazione caricata');
        
    } catch (error) {
        console.error('Errore loadConfiguration:', error);
        showNotification('✗ Errore nel caricamento: ' + error.message, 'error');
    }
};

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 px-4 py-2 rounded-lg text-white z-50 ${
        type === 'error' ? 'bg-red-500' : 'bg-green-500'
    }`;
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

// Inizializzazione
window.addEventListener('load', function() {
    console.log('🚀 Admin panel caricato');
    
    try {
        // Carica configurazione
        loadConfiguration();
        
        // Collega pulsanti
        const saveButton = document.getElementById('save-button');
        const saveButtonBottom = document.getElementById('save-button-bottom');
        
        if (saveButton) {
            saveButton.addEventListener('click', saveConfiguration);
            console.log('✓ Pulsante save-button collegato');
        }
        
        if (saveButtonBottom) {
            saveButtonBottom.addEventListener('click', saveConfiguration);
            console.log('✓ Pulsante save-button-bottom collegato');
        }
        
        console.log('✅ Inizializzazione completata');
        
    } catch (error) {
        console.error('❌ Errore inizializzazione:', error);
    }
});
</script>

</body>
</html>