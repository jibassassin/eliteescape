<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Configurazione Catamarano</title>
<script src="https://cdn.tailwindcss.com/3.4.16"></script>
<script>tailwind.config={theme:{extend:{colors:{primary:'#0a5c8f',secondary:'#f8b400'}}}}</script>
<script src="catamaran-config.js"></script>
<style>
body { font-family: Arial, sans-serif; }
.form-group { margin: 20px 0; }
.form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
.form-group input { width: 100%; max-width: 400px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
.btn { padding: 12px 24px; margin: 10px 5px; border: none; border-radius: 4px; cursor: pointer; }
.btn-primary { background: #0a5c8f; color: white; }
.btn-secondary { background: #6c757d; color: white; }
.status { padding: 10px; margin: 10px 0; border-radius: 4px; }
.status.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
.status.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
</style>
</head>
<body class="bg-gray-50">

<div class="max-w-4xl mx-auto p-6">
    <div class="bg-white rounded-lg shadow-lg p-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-8">Configurazione Catamarano</h1>
        
        <div id="status-message"></div>
        
        <!-- Informazioni Base -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold mb-4">Informazioni Base</h2>
            
            <div class="form-group">
                <label for="admin-catamaran-name">Nome Catamarano:</label>
                <input type="text" id="admin-catamaran-name" placeholder="Es. Bali Catsmart - Violante">
            </div>
            
            <div class="form-group">
                <label for="admin-base-price">Prezzo Base (€):</label>
                <input type="number" id="admin-base-price" placeholder="Es. 3499">
            </div>
            
            <div class="form-group">
                <label for="admin-year">Anno:</label>
                <input type="number" id="admin-year" placeholder="Es. 2025">
            </div>
        </div>
        
        <!-- Prezzi Pacchetti -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold mb-4">Prezzi Pacchetti</h2>
            
            <div class="form-group">
                <label for="admin-charter-price">Prezzo Charter (€):</label>
                <input type="number" id="admin-charter-price" placeholder="Es. 400">
            </div>
            
            <div class="form-group">
                <label for="admin-fuel-price">Prezzo Carburante (€):</label>
                <input type="number" id="admin-fuel-price" placeholder="Es. 350">
            </div>
            
            <div class="form-group">
                <label for="admin-linens-price">Prezzo Lenzuola (€ per ospite):</label>
                <input type="number" id="admin-linens-price" placeholder="Es. 20">
            </div>
        </div>
        
        <!-- Servizi Aggiuntivi -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold mb-4">Servizi Aggiuntivi</h2>
            
            <div class="form-group">
                <label for="admin-skipper-price">Prezzo Skipper (€ al giorno):</label>
                <input type="number" id="admin-skipper-price" placeholder="Es. 200">
            </div>
        </div>
        
        <!-- Pulsanti di Azione -->
        <div class="flex gap-4 pt-6 border-t">
            <button onclick="saveConfiguration()" class="btn btn-primary">
                Salva Configurazione
            </button>
            <button onclick="loadConfiguration()" class="btn btn-secondary">
                Ricarica Configurazione
            </button>
            <button onclick="resetConfiguration()" class="btn btn-secondary">
                Reset Default
            </button>
        </div>
    </div>
</div>

<script>
// Funzioni globali per gestire la configurazione
window.saveConfiguration = function() {
    try {
        const config = CatamaranStorage.load();
        
        // Aggiorna informazioni base
        const nameInput = document.getElementById('admin-catamaran-name');
        const priceInput = document.getElementById('admin-base-price');
        const yearInput = document.getElementById('admin-year');
        
        if (nameInput.value) config.basic.name = nameInput.value;
        if (priceInput.value) {
            config.basic.basePrice = parseInt(priceInput.value);
            config.basic.basePriceDisplay = parseInt(priceInput.value);
        }
        if (yearInput.value) config.basic.year = parseInt(yearInput.value);
        
        // Aggiorna prezzi pacchetti
        const charterPriceInput = document.getElementById('admin-charter-price');
        const fuelPriceInput = document.getElementById('admin-fuel-price');
        const linensPriceInput = document.getElementById('admin-linens-price');
        
        if (charterPriceInput.value) config.mandatoryPackages.charter.price = parseInt(charterPriceInput.value);
        if (fuelPriceInput.value) config.mandatoryPackages.fuel.price = parseInt(fuelPriceInput.value);
        if (linensPriceInput.value) config.mandatoryPackages.linens.pricePerGuest = parseInt(linensPriceInput.value);
        
        // Aggiorna prezzo skipper
        const skipperPriceInput = document.getElementById('admin-skipper-price');
        if (skipperPriceInput.value) config.additionalServices.skipper.price = parseInt(skipperPriceInput.value);
        
        // Salva la configurazione
        const saved = CatamaranStorage.save(config);
        
        if (saved) {
            showStatus('✓ Configurazione salvata con successo!', 'success');
            console.log('Configurazione salvata:', config);
        } else {
            showStatus('✗ Errore nel salvataggio della configurazione', 'error');
        }
        
    } catch (error) {
        showStatus('✗ Errore: ' + error.message, 'error');
        console.error('Errore saveConfiguration:', error);
    }
};

window.loadConfiguration = function() {
    try {
        const config = CatamaranStorage.load();
        
        // Carica informazioni base
        document.getElementById('admin-catamaran-name').value = config.basic.name;
        document.getElementById('admin-base-price').value = config.basic.basePrice;
        document.getElementById('admin-year').value = config.basic.year;
        
        // Carica prezzi pacchetti
        document.getElementById('admin-charter-price').value = config.mandatoryPackages.charter.price;
        document.getElementById('admin-fuel-price').value = config.mandatoryPackages.fuel.price;
        document.getElementById('admin-linens-price').value = config.mandatoryPackages.linens.pricePerGuest;
        
        // Carica prezzo skipper
        document.getElementById('admin-skipper-price').value = config.additionalServices.skipper.price;
        
        showStatus('✓ Configurazione caricata', 'success');
        console.log('Configurazione caricata:', config);
        
    } catch (error) {
        showStatus('✗ Errore nel caricamento: ' + error.message, 'error');
        console.error('Errore loadConfiguration:', error);
    }
};

window.resetConfiguration = function() {
    if (confirm('Sei sicuro di voler resettare la configurazione ai valori di default?')) {
        try {
            const reset = CatamaranStorage.reset();
            if (reset) {
                loadConfiguration();
                showStatus('✓ Configurazione resettata ai valori di default', 'success');
            } else {
                showStatus('✗ Errore nel reset della configurazione', 'error');
            }
        } catch (error) {
            showStatus('✗ Errore: ' + error.message, 'error');
        }
    }
};

function showStatus(message, type) {
    const statusDiv = document.getElementById('status-message');
    statusDiv.innerHTML = '<div class="status ' + type + '">' + message + '</div>';
    setTimeout(() => {
        statusDiv.innerHTML = '';
    }, 5000);
}

// Carica automaticamente la configurazione al caricamento della pagina
document.addEventListener('DOMContentLoaded', function() {
    loadConfiguration();
});
</script>

</body>
</html>